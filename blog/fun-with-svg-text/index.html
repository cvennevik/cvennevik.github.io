<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Having fun with SVG text - Cecilie Vennevik</title>
        <link rel="icon" type="image/jpg" href="/img/logo-32px.jpg" sizes="32x32">
        <link rel="icon" type="image/jpg" href="/img/logo-48px.jpg" sizes="48x48">
        <link rel="icon" type="image/jpg" href="/img/logo-64px.jpg" sizes="64x64">
        <meta name="author" content="Cecilie Vennevik">
        <link rel="alternate" title="Cecilie Vennevik's blog" href="/blog/rss.xml" type="application/rss+xml">
        <link rel="alternate" title="Cecilie Vennevik's blog" href="/blog/atom.xml" type="application/atom+xml">
        <style>
            *,
*::after,
*::before {
	box-sizing: border-box;
}

:root {
	--border-color: #eee;
	--codeblock-color: #f8f8f2;
	--codeblock-background-color: #2b2b2b;
	--home-link-focus-color: #89cff0;

	--background-color: #fff;
	--text-color: #212;
	--code-background-color: #eee;
	--link-color: #086391;
	--link-focus-color: #89cff0;
}

@media (prefers-color-scheme: dark) {
	:root {
		--background-color: #222;
		--text-color: #fff;
		--code-background-color: #444;
		--link-color: #89cff0;
		--link-focus-color: #b8e2f6;
	}
}

:root:has(#light-color-scheme:checked) {
	--background-color: #fff;
	--text-color: #212;
	--code-background-color: #eee;
	--link-color: #086391;
	--link-focus-color: #89cff0;
}

:root:has(#dark-color-scheme:checked) {
	--background-color: #222;
	--text-color: #fff;
	--code-background-color: #444;
	--link-color: #89cff0;
	--link-focus-color: #b8e2f6;
}

html {
	background-color: var(--background-color);
	color: var(--text-color);
	font-family: 'Helvetica Neue', 'Arial Nova', Helvetica, Arial, sans-serif;
	height: 100%;
	line-height: 1.5;
}

body {
	margin: 0 auto;
	max-width: 50rem;
	padding: 1rem;
	padding-bottom: 2rem;
}

h1,
h2,
h3,
h4,
h5,
h6 {
	font-weight: bold;
	line-height: 1.1;
	margin-block-start: 1em;
	margin-block-end: 0;
}

h1 {
	font-size: 2.5rem;
}

h2 {
	font-size: 2rem;
}

h3 {
	font-size: 1.75rem;
}

h4 {
	font-size: 1.5rem;
}

h5 {
	font-size: 1.3rem;
}

h6 {
	font-size: 1.2rem;
}

a {
	color: var(--link-color);
	transition: color .1s;
}

a:focus,
a:hover {
	color: var(--link-focus-color);
}

blockquote {
	border-left: .3rem solid var(--border-color);
	margin: 1rem 0;
	padding: 0 1rem;
}

:not(pre)>code {
	background-color: var(--code-background-color);
}

pre {
	background-color: var(--codeblock-background-color);
	border-radius: 0.5em;
	color: var(--codeblock-color);
	font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace;
	hyphens: none;
	line-height: 1.4;
	padding: 1em;
	overflow: auto;
	tab-size: 4;
	white-space: pre-wrap;
}

img {
	max-width: 100%;
}

figure {
	display: flex;
	flex-direction: column;
	justify-content: center;
	margin: 1.3rem 0;
}

figure img {
	border: .3rem solid var(--border-color);
	border-radius: .3rem;
}

figcaption {
	font-style: italic;
	margin-top: .5em;
	text-align: center;
}
        </style>
        <script>
            // <input-persist> observes all contained input elements with a [data-persist-key] attribute.
// When the user changes the value of an input element, it saves that value to local storage.
// The [data-persist-key] attribute specifies the storage key.
// When an input element first loads - or is placed - inside <input-parsist>, its value is set to the stored value.
//
// <input-persist> supports the following elements:
// - <input type="checkbox">
// - <input type="radio">
customElements.define(
  "input-persist",
  class extends HTMLElement {
    connectedCallback() {
      const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          mutation.removedNodes.forEach((node) => {
            node.removeEventListener("input", this);
          });
          mutation.addedNodes.forEach((node) => {
            if (node.nodeName == "INPUT") {
              node.addEventListener("input", this);
              const persistKey = node.dataset.persistKey;
              if (!persistKey) return;

              const savedValue = localStorage.getItem(persistKey);
              if (savedValue) {
                switch (node.type) {
                  case "checkbox":
                  case "radio":
                    node.checked = savedValue === "checked";
                    break;
                  default:
                    console.warn(
                      `input-persist: cannot persist unsupported element <input type=${node.type}>.`,
                      node
                    );
                    break;
                }
              }
            }
          });
        });
      });
      observer.observe(this, { childList: true, subtree: true });
    }

    handleEvent(event) {
      const persistKey = event.target.dataset.persistKey;
      if (!persistKey) return;

      switch (event.target.type) {
        case "checkbox":
          localStorage.setItem(
            persistKey,
            event.target.checked ? "checked" : "unchecked"
          );
          break;
        case "radio":
          const radioName = event.target.getAttribute("name");
          this.querySelectorAll(`input[name=${radioName}]`).forEach((radio) => {
            if (radio.dataset.persistKey) {
              localStorage.setItem(
                radio.dataset.persistKey,
                radio === event.target ? "checked" : "unchecked"
              );
            }
          });
          break;
        default:
          console.warn(
            `input-persist: cannot persist unsupported element <input type=${event.target.type}>.`,
            event.target
          );
          break;
      }
    }
  }
);

        </script>
    </head>
    <body>
        
<style>
    header {
        text-align: center;
    }

    header a {
        display: inline-block;
        height: 6rem;
        width: 6rem;
    }

    header a img {
        border-radius: 100%;
        transition: border-width .1s;
    }

    header a:hover img,
    header a:focus img {
        border: .3rem solid var(--home-link-focus-color);
    }
</style>
<header>
    <a href="/">
        <img src="/img/logo-250px.jpg" title="Home">
    </a>
</header>

<style>
    h1 {
        margin-block-start: 0;
    }
</style>
<a href="/blog/">&larr; Blog</a>
<article>
    <h1>Having fun with SVG text</h1>
    <i>February 21, 2024</i>
    <p>Last weekend, I redesigned my blog. As part of this redesign, I wanted to make something fun for my front page. I started sketching a bit on paper, got an idea, and soon I was doing a search for &quot;css curved text&quot;.</p>
<p>The first result I found was the <a href="https://css-tricks.com/snippets/svg/curved-text-along-path/">Curved Text Along a Path tutorial</a> by Geoff Graham on CSS Tricks. It demonstrates how to add curved text to a web page using an inline SVG.</p>
<p>It was perfect.</p>
<p>About half an hour of experimenting and browsing the MDN Web Docs later, I was looking at the end result. It's the most beautiful thing I've made in years.</p>
<figure>
    <img
        src="/img/2024-02-18-front-page-screenshot.jpg"
        alt="My new front page, with links to my blog, webroll, Mastodon, and most prominently: a circular photo of a seal plush stuffed into a wine glass, with &quot;Welcome to my website&quot; written in balloon letters around the photo.">
    <figcaption>Pictured: My sweet little boy, trapped in glass.</figcaption>
</figure>
<p>Now, unless you have an above-average interest in HTML, CSS and vector graphics, you may want to tap out of this page now, because the rest of this will be me nerding out over how the sausage is made.</p>
<p>...</p>
<p>Still here?</p>
<p>Good! Let's jump in.</p>
<h2 id="where-we're-going%2C-we-don't-need-photoshop">Where we're going, we don't need Photoshop</h2>
<pre><code class="language-html">&lt;header&gt;
    &lt;svg viewBox=&quot;0 0 500 500&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;
        &lt;title&gt;Welcome to my website&lt;/title&gt;
        &lt;path id=&quot;top-curve&quot; d=&quot;M 100 100 C 100 90, 250 -40, 400 100&quot; stroke=&quot;transparent&quot; fill=&quot;transparent&quot;/&gt;
        &lt;path id=&quot;bottom-curve&quot; d=&quot;M 100 400 C 100 410, 250 540, 400 400&quot; stroke=&quot;transparent&quot; fill=&quot;transparent&quot;/&gt;
        &lt;text aria-hidden=&quot;true&quot; textLength=&quot;340&quot;&gt;
            &lt;textPath xlink:href=&quot;#top-curve&quot;&gt;Welcome to&lt;/textPath&gt;
        &lt;/text&gt;
        &lt;text aria-hidden=&quot;true&quot; textLength=&quot;340&quot;&gt;
            &lt;textPath xlink:href=&quot;#bottom-curve&quot; dominant-baseline=&quot;hanging&quot;&gt;my website&lt;/textPath&gt;
        &lt;/text&gt;
    &lt;/svg&gt;
    &lt;img src=&quot;/img/logo-500px.jpg&quot; alt=&quot;A seal in a wine glass&quot;&gt;
&lt;/header&gt;
</code></pre>
<p>This is the complete HTML for the front page header image and text. It is made up of two main elements:</p>
<ul>
<li>The <code>&lt;img&gt;</code> element, which draws the circular photo in the middle.</li>
<li>The <code>&lt;svg&gt;</code> element, which draws the text around it.</li>
</ul>
<h2 id="a-side-note-on-screen-readers">A side note on screen readers</h2>
<p>The word <em>&quot;draw&quot;</em> can be a bit misleading here, because it may lead you to believe the text is purely graphical.</p>
<figure>
    <img
        src="/img/2024-02-18-front-page-marked-text-v2.jpg"
        alt="Me selecting and highlighting part of the &quot;Welcome to&quot; text.">
    <figcaption>This brings me a silly amount of joy.</figcaption>
</figure>
<p>Yes - the SVG text functions pretty much like regular text! You can select it, copy it, and screen readers will even read it!</p>
<p><strong>That last point is a problem.</strong> When testing how the SVG reads with the built-in screen reader on Windows 11, it was... bad. It just does not read well. It may be that other screen readers handle SVG text better, but I do not want to rely on it.</p>
<p>To improve on this, I went with the most robust-looking solution I could find: I added a <code>&lt;title&gt;</code> element with equivalent text to the SVG, and hid the text elements from screen readers with <code>aria-hidden=&quot;true&quot;</code>. This made the reading experience significantly more pleasant.</p>
<p><em>(If you know of better, more accessible ways to do this, please contact me so I can update this post.)</em></p>
<h2 id="styling">Styling</h2>
<p>To reliably wrap the text around the photo, I needed some reliable styling, and I needed that styling to be responsive across different screen sizes.</p>
<p>I solved this using a CSS grid where:</p>
<ul>
<li>The <code>&lt;img&gt;</code> and <code>&lt;svg&gt;</code> elements are always perfectly square.</li>
<li>They are always the same size.</li>
<li>They shrink on smaller screens.</li>
<li>They are placed directly on top of each other.</li>
</ul>
<pre><code class="language-css">.home-page header {
    display: grid;
    margin: 40px 0px;
    max-width: 500px; /* Will shrink, but keep height proportional if the screen is narrow */
}

.home-page header * {
    /* Place all child elements in the same, single cell of the grid */
    grid-column: 1;
    grid-row: 1;
    /* Ensure identical height and width */
    height: 100%;
    width: 100%;
}

.home-page header img {
    z-index: 1;
    border-radius: 100%; /* Makes the image circular */
    padding: 10%; /* Clears space for text around the image */
}

.home-page header svg {
    z-index: 2;
}
</code></pre>
<p>The image is made square by, well, being a square image. The SVG is made square by the <code>viewBox=&quot;0 0 500 500&quot;</code> property, which defines the internal dimensions of the SVG - the draw positions range from <code>(0,0)</code> to <code>(500,500)</code>.</p>
<p>And while we're in CSS world - the actual SVG text is also styled using CSS!</p>
<pre><code class="language-css">.home-page header svg text {
    fill: #89cff0;
    font-family: babycakes; /* Balloon font! https://www.fontspace.com/babycakes-font-f20531 */
    font-size: 36px;
    text-transform: uppercase;
}
</code></pre>
<h2 id="text%2C-paths%2C-and-text-paths">Text, paths, and text paths</h2>
<p>Let's look at the contents of the <code>&lt;svg&gt;</code> again, and remove <code>&lt;title&gt;</code> and <code>aria-hidden</code> for brevity.</p>
<pre><code class="language-html">&lt;path id=&quot;top-curve&quot; d=&quot;M 100 100 C 100 90, 250 -40, 400 100&quot; stroke=&quot;transparent&quot; fill=&quot;transparent&quot;/&gt;
&lt;path id=&quot;bottom-curve&quot; d=&quot;M 100 400 C 100 410, 250 540, 400 400&quot; stroke=&quot;transparent&quot; fill=&quot;transparent&quot;/&gt;
&lt;text textLength=&quot;340&quot;&gt;
    &lt;textPath xlink:href=&quot;#top-curve&quot;&gt;Welcome to&lt;/textPath&gt;
&lt;/text&gt;
&lt;text textLength=&quot;340&quot;&gt;
    &lt;textPath xlink:href=&quot;#bottom-curve&quot; dominant-baseline=&quot;hanging&quot;&gt;my website&lt;/textPath&gt;
&lt;/text&gt;
</code></pre>
<p>The <code>&lt;text&gt;</code> elements draw text. The <code>textLength</code> attributes say how many pixels long the text should be, and squishes or stretches the text to make it so. I gave both the top and bottom text elements <code>textLength=&quot;340&quot;</code> so they would stretch evenly left-to-right.</p>
<p>Inside them are the <code>&lt;textPath&gt;</code> elements, which draw text along a given path. The <code>xlink:href</code> attributes say which path they should follow. The <code>dominant-baseline=&quot;hanging&quot;</code> attribute places the bottom text <em>below</em> the path, instead of above it.</p>
<p>Finally, the transparent <code>&lt;path&gt;</code> elements supply the curves, as defined by their <code>d</code> attribute.</p>
<p>Can we talk about the curves? I <em>need</em> to talk to you about the curves.</p>
<h2 id="b%C3%A9zier%2C-you-beautiful-man">Bézier, you beautiful man</h2>
<p>Okay, so I've been in the rough vicinity of graphics and animation long enough to have heard &quot;Bézier curves&quot; referenced a few dozen times in my life. I never took the time to look up what they were. I assumed they were complicated and slightly magical, only taught in spellbooks sourced from the Graphics Wizards' tower.</p>
<p>To draw my text exactly how I wanted it, I needed Bézier curves. So I had to up look how they worked, and what all of the coordinates in the code samples meant.</p>
<p>It turns out I was bang on the money. They <em>are</em> magical.</p>
<figure>
    <img
        src="/img/bezier-quadratic.gif"
        alt="Animation of a quadratic (three control point) Bézier curve">
    <figcaption>Ah, Bézier, you've done it again!</figcaption>
</figure>
<p>I cannot hope to give a servicable tutorial for how they work - try the <a href="https://developer.mozilla.org/en-US/docs/Glossary/Bezier_curve">Bézier curve tutorial</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths">SVG Paths tutorial</a> on MDN for that.</p>
<p>In short, they consist of some number of <em>control points</em>, and move from the first control point to the final control point via the fun math-y thing the animation demonstrates. Two control points makes a linear curve (a line), three makes a quadratic curve, four makes a cubic curve, and so on.</p>
<p>This gave me just enough to go on to make a symmetric pair of cubic curves that gently curve around the image.</p>
<pre><code class="language-html">&lt;!-- Cubic curve from (100,100), via (100,90) and (250,-40), to (400,100) --&gt;
&lt;path id=&quot;top-curve&quot; d=&quot;M 100 100 C 100 90, 250 -40, 400 100&quot;/&gt;
</code></pre>
<p>Now, uh. In the middle of writing this, while reading the linked SVG Paths tutorial, I realized I could have made this using a simpler quadratic curve instead.</p>
<pre><code class="language-html">&lt;!-- Quadratic curve from (100,95), via (250,-25), to (400,94) --&gt;
&lt;path id=&quot;top-curve&quot; d=&quot;M 100 95 Q 250 -25, 400 95&quot;/&gt;
</code></pre>
<p>And. I also realized there's a non-Bézier &quot;arc&quot; curve. For drawing arcs. Like around a circle.</p>
<pre><code class="language-html">&lt;!-- Arc from (100,100), in a 210 px radius with sweep-flag enabled, to (400,100) --&gt;
&lt;path id=&quot;top-curve&quot; d=&quot;M 100 100 A 210 210 0 0 1 400 100&quot;/&gt;
</code></pre>
<p>It turns out arcs are a little bit complicated so for this use case I'm happy keeping it a Bézier curve.</p>
<p>Though... throwing a couple of arcs together <em>is</em> a simple way to draw a full circle path... so maybe...</p>
<p>I've already written up everything I learned so far, so let's close on this.</p>
<pre><code class="language-html">&lt;path id=&quot;curve&quot; d=&quot;M 100 100 A 210 210 0 0 1 400 400 A 210 210 0 0 1 100 100&quot; stroke=&quot;transparent&quot; fill=&quot;transparent&quot;/&gt;
&lt;text aria-hidden=&quot;true&quot; textLength=&quot;1320&quot;&gt;
    &lt;textPath xlink:href=&quot;#curve&quot;&gt;
        Imperial futures are only ever stolen presents.
    &lt;/textPath&gt;
&lt;/text&gt;
</code></pre>
<figure>
    <img
        src="/img/2024-02-21-imperial-futures-are-only-ever-stolen-presents.jpg"
        alt="My front page image, but now in a full circle around the photo it says &quot;Imperial futures are only ever stolen presents.&quot;">
    <figcaption>That's all, folks!</figcaption>
</figure>

</article>
    </body>
</html>